# 🚀 快速开始指南

> 本文档帮助你在 5 分钟内跑起来项目 Demo

---

## 📋 前置要求

- Python 3.9+
- macOS / Linux / Windows

---

## ⚡ 最快速的启动方式

```bash
# 1. 进入项目目录
cd "/Users/guangnian/code/25 大语言模型课程项目-2 - 数字人文-训诂分类项目"

# 2. 直接运行演示（无需安装依赖，基础模块已内置）
python3 -m src.main
```

输出示例：

```
============================================================
训诂句类型智能判断系统 - 演示
============================================================

============================================================
分析: 崇，终也
============================================================

[预处理] 被释字: 崇, 释字: 终

[Step 1] 语义关联性分析...
    崇本义: 高大
    终本义: 终结
    结论: 义远

[Step 2] 语音对应分析...
    崇: {'声母': '禅', '韵部': '东', '拟音': '*dzruŋ'}
    终: {'声母': '章', '韵部': '东', '拟音': '*tuŋ'}
    结论: 音近 (韵部相同（东部）；声母不同（禅 vs 章）)

[Step 3] 异文与文例检索...
    结论: 有佐证

[Step 4] 训式识别...
    格式: A也
    暗示类型: 不确定 (置信度: 低)

[Step 5] 语境适配度分析...
    结论: 支持假借

==================================================
最终判断: 假借说明 (置信度: 0.95)
==================================================
```

---

## 🎯 运行模式

### 1. 演示模式（默认）

运行3个预设的示例，展示完整的五步推理流程：

```bash
python3 -m src.main
```

### 2. 评估模式

使用12条预设测试数据运行评估，计算准确率等指标：

```bash
python3 -m src.main --evaluate
```

输出示例：
```
============================================================
评估报告
============================================================

总样本数: 12
正确数: 10
准确率: 83.33%

假借说明:
  精确率: 85.71%
  召回率: 85.71%
  F1: 85.71%

语义解释:
  精确率: 80.00%
  召回率: 80.00%
  F1: 80.00%

宏平均F1: 82.86%
```

### 3. 交互模式

手动输入训诂句进行实时分析：

```bash
python3 -m src.main --interactive
```

示例会话：
```
============================================================
训诂句类型智能判断系统 - 交互模式
============================================================

输入训诂句进行分析，输入 'quit' 退出

请输入训诂句 (格式: A，B也): 海，晦也
请输入原文语境 (可选，直接回车跳过): 

正在分析...

==================================================
最终判断: 语义解释 (置信度: 0.70)
==================================================
```

### 4. 单独测试工具模块

```bash
# 测试训式识别工具（已实现）
python3 src/tools/pattern_tool.py

# 测试Agent框架
python3 src/agent/xungu_agent.py
```

---

## 🔧 完整安装（开发模式）

如果你要进行开发或需要完整功能：

```bash
# 1. 创建虚拟环境
python3 -m venv venv

# 2. 激活虚拟环境
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate   # Windows

# 3. 安装基础依赖
pip install python-dotenv pyyaml rich

# 4. 安装完整依赖（如果需要 LLM API）
pip install -r requirements.txt

# 5. 配置环境变量（如果使用 LLM API）
cp .env.example .env
# 编辑 .env 文件，填入 API Key
```

---

## ⚠️ 当前状态说明

### 已实现功能 ✅

| 模块 | 状态 | 说明 |
|------|------|------|
| 项目骨架 | ✅ 完成 | 完整目录结构和模块划分 |
| 训式识别（Step 4） | ✅ 完成 | 50+ 训释格式的正则匹配 |
| 测试数据集 | ✅ 完成 | 12条预设测试用例 |
| 评估指标 | ✅ 完成 | 准确率/精确率/召回率/F1 |
| CLI 入口 | ✅ 完成 | 演示/评估/交互三种模式 |

### 使用 Mock 数据（待实现）⏳

| 模块 | 当前状态 | 待完成工作 |
|------|----------|------------|
| 语义分析（Step 1） | Mock | 解析 `dyhdc.parsed.fixed.v2.jsonl` |
| 语音分析（Step 2） | Mock | 解析 音韵数据 TXT 文件 |
| 异文检索（Step 3） | Mock | 检索词典例句和假借标注 |
| 语境适配（Step 5） | Mock | 接入 LLM API |
| Agent 核心 | Mock | 实现真实的 LLM 推理 |

---

## 📁 关键文件位置

```
项目根目录/
├── src/main.py              # 主入口，运行这个
├── src/tools/pattern_tool.py # 训式识别（已实现）
├── src/agent/xungu_agent.py  # Agent框架
├── src/evaluation/test_dataset.py  # 测试数据
└── requirements.txt          # Python依赖
```

---

## ❓ 常见问题

### Q1: 运行时报错 `ModuleNotFoundError`

确保你在项目根目录运行，使用 `python3 -m src.main` 而不是 `python3 src/main.py`

### Q2: 运行时报错 `SyntaxError`

确保 Python 版本 >= 3.9，检查命令：
```bash
python3 --version
```

### Q3: 想看更详细的输出

可以直接查看源码或在代码中添加 print 语句调试：
```python
# src/agent/xungu_agent.py 中添加
print(f"[DEBUG] Step1 result: {step1_result}")
```

### Q4: 如何添加自己的测试用例

编辑 `src/evaluation/test_dataset.py`，在 `BUILT_IN_TEST_CASES` 列表中添加：

```python
{
    "id": "custom_001",
    "xungu_sentence": "你的训诂句",
    "beishi_char": "被释字",
    "shi_char": "释字",
    "source": "出处",
    "context": "原文语境",
    "expected_label": "假借说明"  # 或 "语义解释"
}
```

---

## 🎯 下一步

1. 阅读 [IMPLEMENTATION_GUIDE.md](IMPLEMENTATION_GUIDE.md) 了解如何实现各模块
2. 阅读 [TASK_REQUIREMENTS.md](TASK_REQUIREMENTS.md) 理解核心任务要求
3. 阅读 [ARCHITECTURE.md](ARCHITECTURE.md) 理解系统架构
