# ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

> æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ç³»ç»Ÿçš„æ•´ä½“æ¶æ„ã€æ¨¡å—åˆ’åˆ†å’Œæ•°æ®æµ

---

## ğŸ“Š æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                ç”¨æˆ·æ¥å£å±‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   CLI å‘½ä»¤è¡Œ    â”‚  â”‚   Python API    â”‚  â”‚   Web UI (å¯é€‰)  â”‚             â”‚
â”‚  â”‚  python -m src  â”‚  â”‚  agent.analyze() â”‚  â”‚   Gradio/Flask  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Agent æ ¸å¿ƒå±‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        XunguAgent                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚   â”‚
â”‚  â”‚  â”‚   é¢„å¤„ç†å™¨   â”‚  â”‚   æ¨ç†å¼•æ“   â”‚  â”‚   ç»“æœæ•´åˆ   â”‚              â”‚   â”‚
â”‚  â”‚  â”‚ Preprocessor â”‚  â”‚   Reasoner   â”‚  â”‚   Integrator â”‚              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   â”‚
â”‚  â”‚                          â”‚                                           â”‚   â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                                     â”‚   â”‚
â”‚  â”‚                    â”‚   LLM     â”‚   â† Claude/GPT-4                    â”‚   â”‚
â”‚  â”‚                    â”‚  (å¯é€‰)   â”‚                                     â”‚   â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                         â”‚
â”‚                             å·¥å…·è°ƒç”¨æ¥å£                                     â”‚
â”‚                                    â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚Step1å·¥å…· â”‚Step2å·¥å…· â”‚Step3å·¥å…· â”‚Step4å·¥å…· â”‚Step5å·¥å…· â”‚                  â”‚
â”‚  â”‚ Semantic â”‚ Phonologyâ”‚ Textual  â”‚ Pattern  â”‚ Context  â”‚                  â”‚
â”‚  â”‚   Tool   â”‚   Tool   â”‚   Tool   â”‚   Tool   â”‚   Tool   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              çŸ¥è¯†åº“å±‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ã€Šæ±‰è¯­å¤§è¯å…¸ã€‹     â”‚  â”‚     ä¸Šå¤éŸ³æ•°æ®       â”‚  â”‚   è®­å¼è§„åˆ™åº“       â”‚  â”‚
â”‚  â”‚ dyhdc.parsed.*.jsonlâ”‚  â”‚  æ½˜æ‚Ÿäº‘/ç™½æ²™ç³»ç»Ÿ     â”‚  â”‚  XUNSHI_PATTERNS   â”‚  â”‚
â”‚  â”‚       1.9GB         â”‚  â”‚      TXT/XLSX       â”‚  â”‚       Python       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ã€Šç‹åŠ›å¤æ±‰è¯­å­—å…¸ã€‹  â”‚  â”‚     æµ‹è¯•æ•°æ®é›†       â”‚  â”‚    å‚è€ƒèµ„æ–™åº“      â”‚  â”‚
â”‚  â”‚     MDX (å¯é€‰)      â”‚  â”‚       JSON          â”‚  â”‚       TXT          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              è¾“å‡ºå±‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  {                                                                   â”‚   â”‚
â”‚  â”‚    "classification": "å‡å€Ÿè¯´æ˜",                                     â”‚   â”‚
â”‚  â”‚    "confidence": 0.95,                                               â”‚   â”‚
â”‚  â”‚    "reasoning": {                                                    â”‚   â”‚
â”‚  â”‚      "step1": {...}, "step2": {...}, "step3": {...},                â”‚   â”‚
â”‚  â”‚      "step4": {...}, "step5": {...}                                  â”‚   â”‚
â”‚  â”‚    },                                                                â”‚   â”‚
â”‚  â”‚    "final_judgment": "ä¹‰è¿œ+éŸ³è¿‘+æœ‰å¼‚æ–‡+è¯­å¢ƒæ”¯æŒå‡å€Ÿ"                 â”‚   â”‚
â”‚  â”‚  }                                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ main.py                      # ä¸»å…¥å£
â”‚
â”œâ”€â”€ agent/                       # Agent æ ¸å¿ƒ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ xungu_agent.py          # ä¸»Agentç±»
â”‚   â””â”€â”€ prompts.py              # LLM Prompt æ¨¡æ¿
â”‚
â”œâ”€â”€ tools/                       # å·¥å…·å‡½æ•°ï¼ˆäº”æ­¥æ¨ç†ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ semantic_tool.py        # Step1: è¯­ä¹‰åˆ†æ
â”‚   â”œâ”€â”€ phonology_tool.py       # Step2: è¯­éŸ³åˆ†æ
â”‚   â”œâ”€â”€ textual_tool.py         # Step3: å¼‚æ–‡æ£€ç´¢
â”‚   â”œâ”€â”€ pattern_tool.py         # Step4: è®­å¼è¯†åˆ« âœ…
â”‚   â””â”€â”€ context_tool.py         # Step5: è¯­å¢ƒåˆ†æ
â”‚
â”œâ”€â”€ knowledge/                   # çŸ¥è¯†åº“ç®¡ç†
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ dictionary_loader.py    # å­—å…¸æ•°æ®åŠ è½½
â”‚   â””â”€â”€ phonology_loader.py     # éŸ³éŸµæ•°æ®åŠ è½½
â”‚
â”œâ”€â”€ evaluation/                  # è¯„ä¼°æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_dataset.py         # æµ‹è¯•æ•°æ®é›†
â”‚   â””â”€â”€ metrics.py              # è¯„ä¼°æŒ‡æ ‡
â”‚
â”œâ”€â”€ config/                      # é…ç½®
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ settings.py             # å…¨å±€è®¾ç½®
â”‚
â””â”€â”€ data/                        # æ•°æ®å¤„ç†
    â””â”€â”€ __init__.py
```

---

## ğŸ”„ æ•°æ®æµ

### å•æ¬¡åˆ†ææµç¨‹

```
è¾“å…¥: "å´‡ï¼Œç»ˆä¹Ÿ"
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. é¢„å¤„ç† (Preprocessor)                                     â”‚
â”‚    - è§£æè®­è¯‚å¥æ ¼å¼                                          â”‚
â”‚    - æå–è¢«é‡Šå­—(å´‡)å’Œé‡Šå­—(ç»ˆ)                                â”‚
â”‚    - æ ‡å‡†åŒ–è¾“å…¥                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Step 1: è¯­ä¹‰åˆ†æ                                          â”‚
â”‚    - è°ƒç”¨ semantic_tool.query_meaning("å´‡")                  â”‚
â”‚    - è°ƒç”¨ semantic_tool.query_meaning("ç»ˆ")                  â”‚
â”‚    - åˆ¤æ–­: ä¹‰è¿‘/ä¹‰è¿œ                                         â”‚
â”‚    â†’ ç»“æœ: ä¹‰è¿œ                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Step 2: è¯­éŸ³åˆ†æ                                          â”‚
â”‚    - è°ƒç”¨ phonology_tool.query_phonology("å´‡")               â”‚
â”‚    - è°ƒç”¨ phonology_tool.query_phonology("ç»ˆ")               â”‚
â”‚    - æ¯”è¾ƒå£°æ¯ã€éŸµéƒ¨                                          â”‚
â”‚    â†’ ç»“æœ: éŸ³è¿‘ (ä¸œéƒ¨)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Step 3: å¼‚æ–‡æ£€ç´¢                                          â”‚
â”‚    - è°ƒç”¨ textual_tool.search_evidence("å´‡", "ç»ˆ")           â”‚
â”‚    - æŸ¥æ‰¾å¼‚æ–‡ã€å‡å€Ÿæ ‡æ³¨                                      â”‚
â”‚    â†’ ç»“æœ: æœ‰ä½è¯ (ã€Šå°é›…ã€‹å¼‚æ–‡)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Step 4: è®­å¼è¯†åˆ«                                          â”‚
â”‚    - è°ƒç”¨ pattern_tool.identify_pattern("å´‡ï¼Œç»ˆä¹Ÿ")          â”‚
â”‚    - æ­£åˆ™åŒ¹é…è®­é‡Šæ ¼å¼                                        â”‚
â”‚    â†’ ç»“æœ: "Aä¹Ÿ" æ ¼å¼ï¼Œç½®ä¿¡åº¦ä½ï¼Œéœ€ç»¼åˆåˆ¤æ–­                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Step 5: è¯­å¢ƒåˆ†æ                                          â”‚
â”‚    - è·å–åŸæ–‡è¯­å¢ƒ "å´‡æœå…¶é›¨"                                 â”‚
â”‚    - å´‡(é«˜å¤§)ä»£å…¥ â†’ ä¸é€š                                     â”‚
â”‚    - ç»ˆ(æ•´ä¸ª)ä»£å…¥ â†’ é€šé¡º                                     â”‚
â”‚    â†’ ç»“æœ: æ”¯æŒå‡å€Ÿ                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. ç»¼åˆåˆ¤å®š (Integrator)                                     â”‚
â”‚    - ä¹‰è¿œ + éŸ³è¿‘ + æœ‰å¼‚æ–‡ + è¯­å¢ƒæ”¯æŒå‡å€Ÿ                     â”‚
â”‚    - åº”ç”¨åˆ¤å®šè§„åˆ™                                            â”‚
â”‚    â†’ æœ€ç»ˆ: å‡å€Ÿè¯´æ˜ (ç½®ä¿¡åº¦: 0.95)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
è¾“å‡º: { classification: "å‡å€Ÿè¯´æ˜", confidence: 0.95, ... }
```

---

## ğŸ§© æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. XunguAgent (agent/xungu_agent.py)

ä¸»Agentç±»ï¼Œåè°ƒæ•´ä¸ªåˆ†ææµç¨‹ï¼š

```python
class XunguAgent:
    """è®­è¯‚åˆ†ç±»æ™ºèƒ½ä½“"""
    
    def __init__(self, config=None):
        self.config = config or {}
        # åˆå§‹åŒ–å·¥å…·
        self.semantic_tool = SemanticTool()
        self.phonology_tool = PhonologyTool()
        self.textual_tool = TextualTool()
        self.pattern_tool = PatternTool()
        self.context_tool = ContextTool()
    
    def analyze(self, xungu_sentence: str, context: str = None) -> dict:
        """æ‰§è¡Œå®Œæ•´çš„äº”æ­¥åˆ†æ"""
        # 1. é¢„å¤„ç†
        beishi, shi = self._preprocess(xungu_sentence)
        
        # 2. äº”æ­¥æ¨ç†
        step1 = self._step1_semantic(beishi, shi)
        step2 = self._step2_phonetic(beishi, shi)
        step3 = self._step3_textual(beishi, shi)
        step4 = self._step4_pattern(xungu_sentence)
        step5 = self._step5_context(beishi, shi, context)
        
        # 3. ç»¼åˆåˆ¤å®š
        result = self._integrate(step1, step2, step3, step4, step5)
        
        return result
```

### 2. å·¥å…·æ¨¡å— (tools/)

æ¯ä¸ªå·¥å…·è´Ÿè´£ä¸€ä¸ªæ­¥éª¤çš„åˆ¤æ–­ï¼š

| å·¥å…· | æ–‡ä»¶ | è¾“å…¥ | è¾“å‡º |
|------|------|------|------|
| SemanticTool | semantic_tool.py | å­—ç¬¦ | æœ¬ä¹‰ã€ä¹‰é¡¹åˆ—è¡¨ |
| PhonologyTool | phonology_tool.py | å­—ç¬¦ | å£°æ¯ã€éŸµéƒ¨ã€æ‹ŸéŸ³ |
| TextualTool | textual_tool.py | å­—ç¬¦å¯¹ | å¼‚æ–‡ã€å‡å€Ÿæ ‡æ³¨ |
| PatternTool | pattern_tool.py | è®­è¯‚å¥ | æ ¼å¼ã€ç±»å‹ã€ç½®ä¿¡åº¦ |
| ContextTool | context_tool.py | å­—ç¬¦+è¯­å¢ƒ | é€‚é…åº¦åˆ¤æ–­ |

### 3. çŸ¥è¯†åº“æ¨¡å— (knowledge/)

è´Ÿè´£åŠ è½½å’ŒæŸ¥è¯¢å„ç±»æ•°æ®ï¼š

```python
# dictionary_loader.py
class DictionaryLoader:
    def __init__(self, jsonl_path: str):
        self.data = self._load_jsonl(jsonl_path)
        self.index = self._build_index()
    
    def query(self, char: str) -> dict:
        """æŸ¥è¯¢å•å­—çš„æ‰€æœ‰ä¹‰é¡¹"""
        return self.index.get(char, {})

# phonology_loader.py  
class PhonologyLoader:
    def __init__(self, data_dir: str):
        self.data = self._load_all_sources(data_dir)
    
    def query(self, char: str) -> dict:
        """æŸ¥è¯¢å•å­—çš„ä¸Šå¤éŸ³"""
        return {
            "å£°æ¯": ...,
            "éŸµéƒ¨": ...,
            "æ‹ŸéŸ³": ...
        }
```

### 4. è¯„ä¼°æ¨¡å— (evaluation/)

è´Ÿè´£æµ‹è¯•å’Œè¯„ä¼°ï¼š

```python
# test_dataset.py
class TestDataset:
    def __init__(self):
        self.cases = self._load_cases()
    
    def __iter__(self):
        for case in self.cases:
            yield case

# metrics.py
def calculate_metrics(predictions, labels):
    return {
        "accuracy": ...,
        "precision_å‡å€Ÿ": ...,
        "recall_å‡å€Ÿ": ...,
        "f1_å‡å€Ÿ": ...,
        "precision_è¯­ä¹‰": ...,
        "recall_è¯­ä¹‰": ...,
        "f1_è¯­ä¹‰": ...,
        "macro_f1": ...
    }
```

---

## ğŸ”Œ æ¥å£å®šä¹‰

### å·¥å…·å‡½æ•°æ¥å£

æ¯ä¸ªå·¥å…·éƒ½åº”å®ç°ç»Ÿä¸€çš„æ¥å£ï¼š

```python
class BaseTool:
    """å·¥å…·åŸºç±»"""
    
    def __init__(self, config: dict = None):
        """åˆå§‹åŒ–å·¥å…·"""
        pass
    
    def execute(self, *args, **kwargs) -> dict:
        """æ‰§è¡Œå·¥å…·åŠŸèƒ½ï¼Œè¿”å›ç»“æ„åŒ–ç»“æœ"""
        raise NotImplementedError
```

### SemanticTool æ¥å£

```python
class SemanticTool(BaseTool):
    def query_meaning(self, char: str) -> dict:
        """
        æŸ¥è¯¢å­—çš„è¯­ä¹‰ä¿¡æ¯
        
        Returns:
            {
                "char": "å´‡",
                "found": True,
                "meanings": [
                    {"ä¹‰é¡¹": "é«˜å¤§", "type": "æœ¬ä¹‰"},
                    {"ä¹‰é¡¹": "å°Šå´‡", "type": "å¼•ç”³ä¹‰"},
                    ...
                ],
                "primary_meaning": "é«˜å¤§"
            }
        """
        pass
    
    def compare_semantics(self, char_a: str, char_b: str) -> dict:
        """
        æ¯”è¾ƒä¸¤å­—è¯­ä¹‰å…³è”æ€§
        
        Returns:
            {
                "char_a": "å´‡",
                "char_b": "ç»ˆ",
                "meaning_a": "é«˜å¤§",
                "meaning_b": "ç»ˆç»“",
                "relation": "ä¹‰è¿œ",  # ä¹‰è¿‘/ä¹‰è¿œ
                "confidence": 0.9,
                "reasoning": "é«˜å¤§ä¸ç»ˆç»“æ— è¯­ä¹‰å…³è”é“¾æ¡"
            }
        """
        pass
```

### PhonologyTool æ¥å£

```python
class PhonologyTool(BaseTool):
    def query_phonology(self, char: str) -> dict:
        """
        æŸ¥è¯¢å­—çš„ä¸Šå¤éŸ³
        
        Returns:
            {
                "char": "å´‡",
                "found": True,
                "å£°æ¯": "ç¦…",
                "éŸµéƒ¨": "ä¸œ",
                "æ‹ŸéŸ³": "*dzruÅ‹",
                "source": "æ½˜æ‚Ÿäº‘ã€Šæ±‰è¯­å¤éŸ³æ‰‹å†Œã€‹"
            }
        """
        pass
    
    def compare_phonology(self, char_a: str, char_b: str) -> dict:
        """
        æ¯”è¾ƒä¸¤å­—è¯­éŸ³å…³ç³»
        
        Returns:
            {
                "char_a": "å´‡",
                "char_b": "ç»ˆ",
                "relation": "éŸ³è¿‘",  # éŸ³è¿‘/éŸ³è¿œ
                "details": {
                    "éŸµéƒ¨": "ç›¸åŒï¼ˆä¸œéƒ¨ï¼‰",
                    "å£°æ¯": "ä¸åŒä½†ç›¸è¿‘ï¼ˆç¦…/ç« ï¼‰"
                },
                "confidence": 0.85
            }
        """
        pass
```

### PatternTool æ¥å£

```python
class PatternTool(BaseTool):
    def identify_pattern(self, sentence: str) -> dict:
        """
        è¯†åˆ«è®­è¯‚å¥çš„è®­å¼æ ¼å¼
        
        Returns:
            {
                "sentence": "å´‡ï¼Œç»ˆä¹Ÿ",
                "matched_pattern": "Aä¹Ÿ",
                "implied_type": "ä¸ç¡®å®š",  # å‡å€Ÿ/è¯­ä¹‰/ä¸ç¡®å®š
                "direct_judge": False,
                "confidence": "ä½",  # é«˜/ä¸­/ä½
                "source": "åŸºæœ¬è®­å¼ï¼Œéœ€ç»¼åˆåˆ¤æ–­"
            }
        """
        pass
```

### ContextTool æ¥å£

```python
class ContextTool(BaseTool):
    def analyze_context(
        self, 
        beishi: str, 
        shi: str, 
        context: str,
        meaning_beishi: str = None,
        meaning_shi: str = None
    ) -> dict:
        """
        åˆ†æè¯­å¢ƒé€‚é…åº¦
        
        Returns:
            {
                "beishi": "å´‡",
                "shi": "ç»ˆ",
                "context": "å´‡æœå…¶é›¨",
                "analysis": {
                    "beishi_fit": False,  # è¢«é‡Šå­—æœ¬ä¹‰æ˜¯å¦é€šé¡º
                    "shi_fit": True,      # é‡Šå­—æœ¬ä¹‰æ˜¯å¦é€šé¡º
                    "beishi_substituted": "é«˜å¤§æ—©æ™¨ä¸‹é›¨",
                    "shi_substituted": "æ•´ä¸ªæ—©æ™¨ä¸‹é›¨"
                },
                "conclusion": "æ”¯æŒå‡å€Ÿ",  # æ”¯æŒå‡å€Ÿ/æ”¯æŒè¯­ä¹‰/ä¸ç¡®å®š
                "reasoning": "å€Ÿå­—æœ¬ä¹‰ä¸é€šï¼Œæ­£å­—æœ¬ä¹‰é€šé¡º"
            }
        """
        pass
```

---

## ğŸ—ƒï¸ æ•°æ®æ ¼å¼

### ã€Šæ±‰è¯­å¤§è¯å…¸ã€‹JSONL æ ¼å¼

```json
{
    "headword": "å´‡",
    "pronunciations": [...],
    "senses": [
        {
            "sense_num": "1",
            "definition": "é«˜å¤§ã€‚",
            "examples": [...]
        }
    ],
    "cross_refs": [...]
}
```

è¯¦è§ `ã€Šæ±‰è¯­å¤§è¯å…¸ã€‹ç»“æ„åŒ–/dyhdc_jsonl_schema_zh.md`

### ä¸Šå¤éŸ³æ•°æ®æ ¼å¼

æ½˜æ‚Ÿäº‘ã€Šæ±‰è¯­å¤éŸ³æ‰‹å†Œã€‹TXTæ ¼å¼ï¼š
```
å­—	è²æ¯	éŸ»éƒ¨	æ‹ŸéŸ³
å´‡	ç¦…	ä¸œ	*dzruÅ‹
ç»ˆ	ç« 	ä¸œ	*tuÅ‹
```

### æµ‹è¯•æ•°æ®é›†æ ¼å¼

```json
{
    "id": "test_001",
    "xungu_sentence": "å´‡ï¼Œç»ˆä¹Ÿ",
    "beishi_char": "å´‡",
    "shi_char": "ç»ˆ",
    "source": "ã€Šè¯—Â·é‚¶é£Â·ç®€å…®ã€‹æ¯›ä¼ ",
    "context": "å´‡æœå…¶é›¨",
    "expected_label": "å‡å€Ÿè¯´æ˜",
    "explanation": "ä¹‰è¿œéŸ³è¿‘ï¼Œæœ‰å¼‚æ–‡ä½è¯"
}
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ (.env)

```bash
# LLM API é…ç½®
OPENAI_API_KEY=sk-xxx
ANTHROPIC_API_KEY=xxx

# æ¨¡å‹é€‰æ‹©
LLM_PROVIDER=anthropic  # openai / anthropic
LLM_MODEL=claude-3-5-sonnet-20241022

# æ•°æ®è·¯å¾„
DYHDC_PATH=./ã€Šæ±‰è¯­å¤§è¯å…¸ã€‹ç»“æ„åŒ–/dyhdc.parsed.fixed.v2.jsonl
PHONOLOGY_PATH=./éŸ³éŸµæ•°æ®/ä¸Šå¤éŸ³/

# æ—¥å¿—çº§åˆ«
LOG_LEVEL=INFO
```

### settings.py

```python
class Settings:
    # è·¯å¾„é…ç½®
    PROJECT_ROOT = Path(__file__).parent.parent.parent
    DATA_ROOT = PROJECT_ROOT / "data"
    
    # æ¨¡å‹é…ç½®
    LLM_PROVIDER = os.getenv("LLM_PROVIDER", "anthropic")
    LLM_MODEL = os.getenv("LLM_MODEL", "claude-3-5-sonnet-20241022")
    
    # å·¥å…·é…ç½®
    USE_MOCK_DATA = True  # æ˜¯å¦ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
    
    # è¯„ä¼°é…ç½®
    TEST_DATA_PATH = DATA_ROOT / "test" / "test_dataset.json"
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¼€å§‹](QUICK_START.md)
- [ä»»åŠ¡è¦æ±‚](TASK_REQUIREMENTS.md)
- [å®ç°æŒ‡å—](IMPLEMENTATION_GUIDE.md)
- [å¼€å‘è®¡åˆ’](DEVELOPMENT_PLAN.md)
