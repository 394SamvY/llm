# é¡¹ç›®åç»­å·¥ä½œä¾èµ–å…³ç³»

> **æ›´æ–°æ—¥æœŸ**: 2026-01-17  
> **å½“å‰çŠ¶æ€**: æˆå‘˜Eæ•°æ®å·¥ç¨‹å·²å®Œæˆï¼Œç­‰å¾…å·¥å…·å±‚æ¥å…¥çœŸå®æ•°æ®

---

## ğŸ“Š é¡¹ç›®å®Œæˆåº¦æ€»è§ˆ

```
æ•´ä½“è¿›åº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 60%

â”œâ”€â”€ æ•°æ®å·¥ç¨‹ (æˆå‘˜E)     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
â”œâ”€â”€ å·¥å…·å±‚ (æˆå‘˜C/D)     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 40%  âš ï¸
â”œâ”€â”€ Agentæ ¸å¿ƒ (æˆå‘˜B)    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 40%  âš ï¸
â””â”€â”€ æ•´åˆæµ‹è¯• (æˆå‘˜A)     â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%   ğŸ“‹
```

---

## ğŸ”— ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           é¡¹ç›®ä¾èµ–å…³ç³»                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    LLM API é…ç½®      â”‚
                    â”‚   (OpenAI/Claude)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ ä¾èµ–
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æˆå‘˜Eæ•°æ®å·¥ç¨‹   â”‚    â”‚    æˆå‘˜C/Då·¥å…·å¼€å‘    â”‚    â”‚   æˆå‘˜B Agent    â”‚
â”‚      âœ… å®Œæˆ      â”‚â”€â”€â”€â–ºâ”‚      âš ï¸ è¿›è¡Œä¸­       â”‚â”€â”€â”€â–ºâ”‚    âš ï¸ å¾…æµ‹è¯•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                            â”‚
        æä¾›æ•°æ®                   æ¥å…¥æ•°æ®                    â”‚ ä¾èµ–
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
        â”‚ â€¢ phonology_unified.json (éŸ³éŸµç´¢å¼•)     â”‚          â–¼
        â”‚ â€¢ dyhdc_index.json (è¯å…¸ç´¢å¼•)          â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ â€¢ test_dataset.json (æµ‹è¯•é›†60æ¡)       â”‚    â”‚   æˆå‘˜A æ•´åˆæµ‹è¯•   â”‚
        â”‚ â€¢ è¯„ä¼°æ¨¡å— (metrics.py)               â”‚    â”‚     ğŸ“‹ æœ€åé˜¶æ®µ    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ å„æ¨¡å—è¯¦ç»†çŠ¶æ€

### âœ… æˆå‘˜E - æ•°æ®å·¥ç¨‹ (å·²å®Œæˆ)

| ä»»åŠ¡ | äº§å‡ºæ–‡ä»¶ | çŠ¶æ€ |
|------|----------|:----:|
| éŸ³éŸµæ•°æ®è§£æ | `src/data/phonology_parser.py` | âœ… |
| éŸ³éŸµæ•°æ®ç´¢å¼• | `data/processed/phonology_unified.json` | âœ… |
| è¯å…¸ç´¢å¼•æ„å»º | `src/data/dyhdc_index_builder.py` | âœ… |
| è¯å…¸åç§»é‡ç´¢å¼• | `data/processed/dyhdc_index.json` | âœ… |
| æµ‹è¯•æ•°æ®é›† | `data/test/test_dataset.json` (60æ¡) | âœ… |
| è¯„ä¼°æŒ‡æ ‡ | `src/evaluation/metrics.py` | âœ… |
| é”™è¯¯åˆ†æ | `src/evaluation/error_analysis.py` | âœ… |
| æ¥å£æ–‡æ¡£ | `docs/DATA_ENGINEERING_API.md` | âœ… |

**æä¾›ç»™å…¶ä»–æˆå‘˜çš„æ¥å£ï¼š**
- `load_phonology_data()` - åŠ è½½éŸ³éŸµæ•°æ®
- `compare_phonology()` - æ¯”è¾ƒä¸¤å­—éŸ³éŸµ
- `DYHDCIndexLoader` - è¯å…¸æŸ¥è¯¢
- `load_test_dataset()` - åŠ è½½æµ‹è¯•é›†
- `evaluate_results()` - è¯„ä¼°Agentç»“æœ

---

### âœ… æˆå‘˜C - è¯­ä¹‰å·¥å…·å¼€å‘ (å·²å®Œæˆ)

| å·¥å…· | æ–‡ä»¶ | å½“å‰çŠ¶æ€ | è¯´æ˜ |
|------|------|:--------:|------|
| è¯­ä¹‰æŸ¥è¯¢ | `semantic_tool.py` | âœ… å®Œæˆ | å·²æ¥å…¥ `DYHDCIndexLoader` |
| æ–‡çŒ®æ£€ç´¢ | `textual_tool.py` | âœ… å®Œæˆ | å¯ä»è¯å…¸æå–å‡å€Ÿæ ‡æ³¨ |
| è®­å¼è¯†åˆ« | `pattern_tool.py` | âœ… å®Œæˆ | å·²å¯ç”¨ |

**ä½¿ç”¨æ–¹å¼ï¼š**

```python
from src.tools import query_word_meaning, search_textual_evidence, identify_pattern

# è¯­ä¹‰æŸ¥è¯¢
result = query_word_meaning("å´‡")
print(result["æœ¬ä¹‰"])  # "é«˜ï¼›é«˜å¤§ã€‚"

# æ–‡çŒ®æ£€ç´¢
evidence = search_textual_evidence("å´‡", "çµ‚", context="å´‡æœå…¶é›¨")
print(evidence["æœ‰ä½è¯"])  # True/False

# è®­å¼è¯†åˆ«
pattern = identify_pattern("å´‡ï¼Œè®€ç‚ºçµ‚")
print(pattern["æš—ç¤ºç±»å‹"])  # "å‡å€Ÿ"
```

**è¯¦ç»†æ–‡æ¡£**ï¼šå‚è§ `docs/TOOLS_API.md`

**å‰ç½®æ¡ä»¶**ï¼šéœ€è¦å…ˆæ„å»ºç´¢å¼•æ–‡ä»¶
```bash
python -c "from src.data.dyhdc_index_builder import build_dyhdc_index; build_dyhdc_index()"
```

---

### âš ï¸ æˆå‘˜D - éŸ³éŸµå·¥å…·å¼€å‘ (éœ€è¦æ¥å…¥æ•°æ®)

| å·¥å…· | æ–‡ä»¶ | å½“å‰çŠ¶æ€ | éœ€è¦åš |
|------|------|:--------:|--------|
| éŸ³éŸµæŸ¥è¯¢ | `phonology_tool.py` | âš ï¸ Mock | æ¥å…¥ `phonology_unified.json` |
| è¯­å¢ƒåˆ†æ | `context_tool.py` | âš ï¸ Mock | æ¥å…¥ LLM API |

**ä¿®æ”¹ç¤ºä¾‹ - `phonology_tool.py`ï¼š**

```python
# æ›¿æ¢ load() æ–¹æ³•ä¸­çš„ mock æ•°æ®
def load(self) -> None:
    if self._loaded:
        return
    
    # ä½¿ç”¨æˆå‘˜Eæä¾›çš„éŸ³éŸµç´¢å¼•
    from src.data import load_phonology_data, compare_phonology
    self._phonology_data = load_phonology_data(
        "data/processed/phonology_unified.json"
    )
    self._loaded = True

def query(self, char: str) -> PhonologyInfo:
    if not self._loaded:
        self.load()
    
    if char in self._phonology_data:
        data = self._phonology_data[char]
        pan = data.get("æ½˜æ‚Ÿäº‘", {})
        return PhonologyInfo(
            char=char,
            shengmu=pan.get("å£°æ¯", "æœªçŸ¥"),
            yunbu=pan.get("éŸµéƒ¨", "æœªçŸ¥"),
            reconstruction=pan.get("ä¸Šå¤éŸ³", "æœªçŸ¥"),
            source="æ½˜æ‚Ÿäº‘ã€Šæ±‰è¯­å¤éŸ³æ‰‹å†Œã€‹"
        )
    else:
        return PhonologyInfo(char=char, shengmu="æœªæ”¶å½•", ...)

def is_phonetically_close(self, char1: str, char2: str) -> Dict:
    # ç›´æ¥ä½¿ç”¨æˆå‘˜Eæä¾›çš„æ¯”è¾ƒå‡½æ•°
    from src.data import compare_phonology
    return compare_phonology(char1, char2, self._phonology_data)
```

---

### âš ï¸ æˆå‘˜B - Agentæ ¸å¿ƒ (ç­‰å¾…å·¥å…·å®Œæˆ)

| æ¨¡å— | æ–‡ä»¶ | å½“å‰çŠ¶æ€ | ä¾èµ– |
|------|------|:--------:|------|
| Agentç±» | `xungu_agent.py` | âš ï¸ æ¡†æ¶å®Œæˆ | å·¥å…·å±‚ |
| Prompt | `prompts.py` | âš ï¸ å¾…ä¼˜åŒ– | æµ‹è¯•åé¦ˆ |
| åˆ¤æ–­é€»è¾‘ | `_final_judgment()` | âš ï¸ å¾…è°ƒä¼˜ | è¯„ä¼°æ•°æ® |

**å·¥ä½œæµç¨‹ï¼š**
1. ç­‰å¾…æˆå‘˜C/Då®Œæˆå·¥å…·æ¥å…¥
2. è¿è¡Œæµ‹è¯•é›†éªŒè¯Agent
3. æ ¹æ®é”™è¯¯åˆ†æä¼˜åŒ–Promptå’Œåˆ¤æ–­é€»è¾‘
4. è¿­ä»£ä¼˜åŒ–ç›´åˆ°è¾¾åˆ°ç›®æ ‡å‡†ç¡®ç‡

---

### ğŸ“‹ æˆå‘˜A - æ•´åˆæµ‹è¯• (æœ€åé˜¶æ®µ)

| ä»»åŠ¡ | è¯´æ˜ | ä¾èµ– |
|------|------|------|
| é›†æˆæµ‹è¯• | è¿è¡Œ60æ¡æµ‹è¯•é›† | å…¨éƒ¨æ¨¡å—å®Œæˆ |
| æ€§èƒ½è¯„ä¼° | è®¡ç®—å‡†ç¡®ç‡ã€F1ç­‰ | Agentå®Œæˆ |
| é”™è¯¯åˆ†æ | åˆ†æé”™è¯¯æ¨¡å¼ | è¯„ä¼°ç»“æœ |
| æ–‡æ¡£æ•´ç† | ç­”è¾©ææ–™å‡†å¤‡ | å…¨éƒ¨å®Œæˆ |

---

## ğŸš€ ä»»åŠ¡æ‰§è¡Œé¡ºåº

```
Phase 1: å·¥å…·æ¥å…¥ (æˆå‘˜C/Då¹¶è¡Œ)
â”œâ”€â”€ C1: semantic_tool.py æ¥å…¥è¯å…¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”œâ”€â”€ C2: textual_tool.py å¢å¼ºå¼‚æ–‡æ£€ç´¢ â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€ D1: phonology_tool.py æ¥å…¥éŸ³éŸµ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â–º Phase 2
â””â”€â”€ D2: context_tool.py æ¥å…¥LLM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
Phase 2: Agentæµ‹è¯• (æˆå‘˜B)                   â”‚
â”œâ”€â”€ B1: è¿è¡Œæµ‹è¯•é›† â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”œâ”€â”€ B2: åˆ†æé”™è¯¯æ¡ˆä¾‹
â”œâ”€â”€ B3: ä¼˜åŒ–Prompt
â””â”€â”€ B4: è°ƒæ•´åˆ¤æ–­é€»è¾‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Phase 3
                                              â”‚
Phase 3: æ•´åˆè¯„ä¼° (æˆå‘˜A)                      â”‚
â”œâ”€â”€ A1: å®Œæ•´é›†æˆæµ‹è¯• â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”œâ”€â”€ A2: ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š
â”œâ”€â”€ A3: å‡†å¤‡ç­”è¾©ææ–™
â””â”€â”€ A4: é¡¹ç›®äº¤ä»˜
```

---

## ğŸ“ å…³é”®æ¥å£é€ŸæŸ¥

### æˆå‘˜E â†’ æˆå‘˜C (è¯­ä¹‰å·¥å…·)

```python
from src.data import DYHDCIndexLoader

loader = DYHDCIndexLoader(
    "ã€Šæ±‰è¯­å¤§è¯å…¸ã€‹ç»“æ„åŒ–/dyhdc.parsed.fixed.v2.jsonl",
    "data/processed/dyhdc_index.json"
)

# æŸ¥è¯¢å•å­—
result = loader.query_single_char("å´‡")
# è¿”å›: {"å­—": "å´‡", "æœ¬ä¹‰": "é«˜å¤§", "ä¹‰é¡¹": [...], "å‡å€Ÿæ ‡æ³¨": [...]}
```

### æˆå‘˜E â†’ æˆå‘˜D (éŸ³éŸµå·¥å…·)

```python
from src.data import load_phonology_data, compare_phonology

# åŠ è½½æ•°æ®
data = load_phonology_data("data/processed/phonology_unified.json")

# æŸ¥è¯¢å•å­—
char_info = data.get("å´‡")
# è¿”å›: {"æ½˜æ‚Ÿäº‘": {"éŸµéƒ¨": "...", "ä¸Šå¤éŸ³": "...", "å£°æ¯": "..."}, ...}

# æ¯”è¾ƒä¸¤å­—
result = compare_phonology("å´‡", "ç»ˆ", data)
# è¿”å›: {"éŸ³è¿‘": True, "éŸµéƒ¨ç›¸åŒ": True, "å£°æ¯ç›¸è¿‘": False, ...}
```

### æˆå‘˜E â†’ æˆå‘˜B (è¯„ä¼°)

```python
from src.evaluation import load_test_dataset, evaluate_results, ErrorAnalyzer

# åŠ è½½æµ‹è¯•é›†
dataset = load_test_dataset("data/test/test_dataset.json")

# è¯„ä¼°Agentç»“æœ
report = evaluate_results(agent_results, dataset)

# é”™è¯¯åˆ†æ
analyzer = ErrorAnalyzer()
analyzer.add_errors(report["errors"])
analyzer.print_report()
```

---

## â° é¢„ä¼°æ—¶é—´

| é˜¶æ®µ | ä»»åŠ¡ | é¢„ä¼°æ—¶é—´ | è´Ÿè´£äºº |
|------|------|:--------:|--------|
| Phase 1 | å·¥å…·æ¥å…¥çœŸå®æ•°æ® | 1-2å¤© | C/D |
| Phase 2 | Agentæµ‹è¯•ä¸ä¼˜åŒ– | 2-3å¤© | B |
| Phase 3 | æ•´åˆä¸æ–‡æ¡£ | 1-2å¤© | A |
| **æ€»è®¡** | | **4-7å¤©** | |

---

## ğŸ”” æ³¨æ„äº‹é¡¹

1. **ç¹ç®€ä½“é—®é¢˜**ï¼šéŸ³éŸµå’Œè¯å…¸æ•°æ®ä½¿ç”¨ç¹ä½“å­—ï¼ŒæŸ¥è¯¢æ—¶éœ€æ³¨æ„
2. **LLM API**ï¼šè¯­å¢ƒåˆ†æå·¥å…·éœ€è¦é…ç½®API Key
3. **å¤§æ–‡ä»¶**ï¼šæ¨é€Gitæ—¶æ³¨æ„æ’é™¤å¤§å‹ç´¢å¼•æ–‡ä»¶
4. **æµ‹è¯•ä¼˜å…ˆ**ï¼šæ¯å®Œæˆä¸€ä¸ªæ¨¡å—æ¥å…¥ï¼Œç«‹å³è¿è¡Œæµ‹è¯•éªŒè¯

---

*æœ¬æ–‡æ¡£å°†éšé¡¹ç›®è¿›å±•æŒç»­æ›´æ–°*
